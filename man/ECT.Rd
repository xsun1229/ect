% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ECT.R
\name{ECT}
\alias{ECT}
\title{Effect Consistency Test (ECT)}
\usage{
ECT(
  assoc_pair,
  factor_name,
  num_snp_cutoff = 3,
  snp_fdr_cutoff = 0.2,
  seeds = 1000,
  resample_stages = c(1000, 10000, 1e+06),
  p_thresholds = c(0.1, 0.001),
  col_beta_exposure = "beta.exposure",
  col_beta_outcome = "beta.outcome",
  col_pval_exposure = "pval.exposure"
)
}
\arguments{
\item{assoc_pair}{Data frame containing association summary statistics for a
given factor. Must include columns specified by \code{col_beta_exposure},
\code{col_beta_outcome}, and \code{col_pval_exposure}.}

\item{factor_name}{Character string indicating the name of the factor or pathway.}

\item{num_snp_cutoff}{Minimum number of supporting SNPs required to perform the
test (default: \code{3}).}

\item{snp_fdr_cutoff}{FDR threshold used to select supporting SNPs based on
\code{col_pval_exposure} (default: \code{0.2}).}

\item{seeds}{Base random seed for reproducibility (default: \code{1000}).}

\item{resample_stages}{Integer vector specifying the number of resampling
iterations for each adaptive stage (default: \code{c(1e3, 1e4, 1e6)}).}

\item{p_thresholds}{Numeric vector of stopping thresholds for adaptive
resampling (default: \code{c(0.1, 0.001)}).}

\item{col_beta_exposure}{Column name for exposure effect sizes (default: \code{"beta.exposure"}).}

\item{col_beta_outcome}{Column name for outcome effect sizes (default: \code{"beta.outcome"}).}

\item{col_pval_exposure}{Column name for exposure p-values (default: \code{"pval.exposure"}).}
}
\value{
A data frame containing the following columns:
\itemize{
\item \code{factor_name}: factor/pathway tested
\item \code{p_std}: p-value from the observed linear regression
\item \code{r_std}: R² from the observed regression
\item \code{p_ECT}: empirical p-value from adaptive resampling
\item \code{num_supp_SNP}: number of SNPs used in the test
}

If the number of supporting SNPs is below \code{num_snp_cutoff}, the function
returns a placeholder row indicating insufficient SNPs.
}
\description{
Performs an adaptive resampling-based Effect Consistency Test (ECT) to evaluate
whether SNP effect sizes on an outcome (e.g.,GWAS trait) are consistent with those
on an exposure (e.g., pathway-level factor). The test compares the observed R² from
the exposure–outcome regression against a null distribution obtained by
permutation of outcome effects.
}
\details{
The function fits a no-intercept linear model:
\deqn{beta_outcome ~ 0 + beta_exposure}
and compares its R² to those obtained after permuting outcome effect sizes.
Resampling proceeds through progressively larger sample sizes until the
empirical p-value exceeds the corresponding threshold in \code{p_thresholds} or
all stages are completed.
}
\examples{
\dontrun{
ECT(
  assoc_pair = mydata,
  factor_name = "pathway_PC1",
  snp_fdr_cutoff = 0.1,
  resample_stages = c(1e3, 1e4),
  p_thresholds = c(0.05, 0.001)
)
}

}

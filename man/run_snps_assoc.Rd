% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_snps_assoc.R
\name{run_snps_assoc}
\alias{run_snps_assoc}
\title{Run PLINK-based SNP association analyses in parallel}
\usage{
run_snps_assoc(
  snp_list,
  folder_covar,
  folder_assoc,
  plink_path,
  file_bfile,
  file_phe,
  single_factor = NULL,
  add_MAF = TRUE,
  df_maf = NULL,
  ncores = 4,
  cleanup = FALSE,
  group_by_factor = TRUE
)
}
\arguments{
\item{snp_list}{Character vector of SNP IDs to analyze.}

\item{folder_covar}{Path to the folder containing SNP-specific covariate files, in PLINK format
(e.g., \code{"snp123.cov.txt"}).}

\item{folder_assoc}{Path to the output folder for PLINK association results.}

\item{plink_path}{Path to the PLINK executable.}

\item{file_bfile}{PLINK binary file prefix (\code{.bed/.bim/.fam}).}

\item{file_phe}{Path to the phenotype file to be analyzed by PLINK.
This file should contain the phenotype columns (i.e., the factors)
that are later referenced by \code{group_by_factor} to group and summarize
association results.}

\item{single_factor}{Optional; a single phenotype name (column name from
\code{file_phe}) to test individually. If \code{NULL}, all phenotypes in
\code{file_phe} are analyzed (\code{--all-pheno} mode).}

\item{add_MAF}{Logical; if \code{TRUE}, the function merges association results
with a MAF table. When \code{add_MAF = TRUE}, the argument \code{df_maf} \strong{must}
be provided. If \code{FALSE}, MAF information is ignored and \code{df_maf} can be
left as \code{NULL}.}

\item{df_maf}{Data frame containing columns \code{SNP}, \code{A2}, and \code{MAF}.
Required only when \code{add_MAF = TRUE}; otherwise leave it as \code{NULL}.}

\item{ncores}{Number of CPU cores to use for parallel processing.}

\item{cleanup}{Logical; if \code{TRUE}, removes intermediate \code{.assoc} files
after grouping.}

\item{group_by_factor}{Logical; if \code{TRUE}, the function combines all SNP-level
results and groups them by phenotype factors defined in \code{file_phe}.}
}
\value{
Writes PLINK association results into \verb{folder_assoc/} and (optionally)
grouped per-factor summary files (e.g., \code{"factor_pvalues.txt"}). Returns no
explicit object.
}
\description{
Performs SNP-level association analyses for a given list of SNPs by invoking
PLINK in parallel. Each SNP is tested using its own covariate file, and
association results can optionally be grouped by phenotype factors.
}
\details{
Each SNP is processed in its own subfolder under \verb{folder_assoc/} to avoid
overwriting during parallel execution. Only additive test results
(\code{TEST == "ADD"}) are retained.
}
\examples{
\dontrun{
run_snps_assoc(
  snp_list = c("rs123", "rs456"),
  folder_covar = "covariates/",
  folder_assoc = "assoc_results/",
  plink_path = "/usr/bin/plink",
  file_bfile = "data/genotypes",
  file_phe = "data/pheno.txt",
  add_MAF = TRUE,
  df_maf = maf_table,
  ncores = 4
)
}

}

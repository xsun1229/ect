% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prune_snps.R
\name{prune_snps}
\alias{prune_snps}
\title{Prune SNPs based on clumping and LD thresholds using PLINK}
\usage{
prune_snps(
  file_sumstats,
  plink_path,
  bfile,
  out.dir,
  out.pref,
  clean_up = FALSE
)
}
\arguments{
\item{file_sumstats}{Path to the GWAS summary statistics file containing
columns \code{SNP}, \code{CHR}, \code{BP}, and \code{P}.}

\item{plink_path}{Path to the PLINK executable.}

\item{bfile}{PLINK binary file prefix (\code{.bed/.bim/.fam}) used as the LD reference.}

\item{out.dir}{Output directory where intermediate and result files will be written.}

\item{out.pref}{Prefix for temporary PLINK output and final file naming.}

\item{clean_up}{Logical; if \code{TRUE}, temporary files and subdirectories are deleted
after successful completion or if errors occur.}
}
\value{
A \code{data.table} of pruned GWAS summary statistics containing the same columns as
the input file but restricted to SNPs that remain after distance- and LD-based
pruning. Returns \code{NULL} if PLINK clumping fails to produce output.
}
\description{
Performs SNP pruning in two stages: (1) PLINK-based clumping to select
approximately independent lead SNPs, and (2) additional distance- and
LD-based pruning to further reduce correlated variants.

The function generates temporary files under a subdirectory of \code{out.dir},
invokes PLINK commands, and returns a pruned GWAS summary statistics table.
}
\details{
The pruning proceeds in the following steps:
\enumerate{
\item \strong{PLINK clumping:} using thresholds \verb{--clump-p1 5e-8}, \verb{--clump-p2 1e-3},
\verb{--clump-r2 0.1}, and \verb{--clump-kb 1000}.
\item \strong{Distance-based pruning:} removes SNPs within ±1 Mb of a more significant SNP.
\item \strong{LD-based pruning:} calculates pairwise LD (\verb{r²}) using PLINK and removes
SNPs with \verb{r² > 0.1} relative to previously retained variants.
\item Returns GWAS summary statistics restricted to the remaining independent SNPs.
}
}
\examples{
\dontrun{
pruned_gwas <- prune_snps(
  file_sumstats = "assoc/gwas.txt",
  plink_path = "/usr/bin/plink",
  bfile = "ref/1000G_EUR",
  out.dir = "pruning_results/",
  out.pref = "GWAS1",
  clean_up = TRUE
)
}

}

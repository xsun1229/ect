[{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 XSun Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"/articles/getting_started.html","id":"install-ect","dir":"Articles","previous_headings":"","what":"Install ECT","title":"Tutorial for ect","text":"Use devtools install latest version ect GitHub: Currently, ect tested Linux systems.","code":"install.packages(\"devtools\") devtools::install_github(\"xsun1229/ect\")"},{"path":"/articles/getting_started.html","id":"select-independent-snps","dir":"Articles","previous_headings":"","what":"Select independent SNPs","title":"Tutorial for ect","text":"prune_snps() function performs two-stage SNP pruning identify set approximately independent lead variants GWAS summary statistics file. integrates PLINK-based clumping, distance-based filtering, LD-based pruning using user-specified PLINK genotype reference panel. function designed downstream analyses require independence among variants, variant–factor association tests. pruning proceeds three sequential steps: PLINK clumping (primary selection lead SNPs) step uses GWAS summary statistics together PLINK genotype reference (bfile) perform LD clumping. following PLINK thresholds used default: --clump-p1 5e-8 --clump-p2 1e-3 --clump-r2 0.1 --clump-kb 1000 Clumping produces initial set approximately independent lead variants. Distance-based pruning SNPs retained clumping, SNP located within ±1 Mb significant SNP removed. step enforces spatial independence, giving priority SNPs smaller p-values. LD-based pruning Pairwise LD (r²) computed using PLINK remaining SNPs. SNPs r² > 0.1 relative previously retained variants removed. Final output completing steps, function returns set independent, genome-wide significant variants, ready downstream analyses association testing ACAT aggregation.","code":""},{"path":"/articles/getting_started.html","id":"usage","dir":"Articles","previous_headings":"Select independent SNPs","what":"Usage","title":"Tutorial for ect","text":"","code":"prune_snps(   file_sumstats,   plink_path,   bfile,   out.dir,   out.pref,   clean_up = FALSE )"},{"path":"/articles/getting_started.html","id":"example","dir":"Articles","previous_headings":"Select independent SNPs","what":"Example","title":"Tutorial for ect","text":"","code":"file_sumstats <- system.file(\"extdata\", \"example_sumstats.txt\", package = \"ect\") bfile <- sub(\"\\\\.bed$\", \"\", system.file(\"extdata/example.bed\", package = \"ect\"))  pruned_snps <- prune_snps(   file_sumstats = file_sumstats,   plink_path = plink_path,   bfile = bfile,   out.dir = tempdir(),   out.pref = \"example\",   clean_up = TRUE )  print(pruned_snps) #>          SNP   CHR      POS    REF    ALT       BETA        SE     AF #>       <char> <int>    <int> <char> <char>      <num>     <num>  <num> #> 1: rs2143178    22 39660829      T      C -0.1766840 0.0137017 0.1658 #> 2: rs1003342    22 30570022      A      G -0.0801818 0.0101765 0.5459 #> 3: rs2283789    22 21944478      T      G  0.0887993 0.0122872 0.1997 #>               P #>           <num> #> 1: 4.799544e-38 #> 2: 3.296856e-15 #> 3: 4.938556e-13"},{"path":"/articles/getting_started.html","id":"effect-consistency-test","dir":"Articles","previous_headings":"","what":"Effect Consistency Test","title":"Tutorial for ect","text":"ECT() function performs adaptive resampling-based Effect Consistency Test (ECT) evaluate whether SNP effect sizes outcome (e.g., GWAS trait) consistent effects exposure variable (e.g., pathway-derived expression factor). method compares observed R² -intercept regression outcome effects exposure effects null distribution generated permuting outcome effect sizes. ECT proceeds following steps: Select supporting SNPs Supporting SNPs defined exposure-side p-values FDR threshold (snp_fdr_cutoff, default 0.2). test performed number supporting SNPs ≥ num_snp_cutoff (default 3). Fit observed regression -intercept model fitted: βoutcome=γ⋅βexposure+ε, \\beta_{\\text{outcome}} = \\gamma \\cdot \\beta_{\\text{exposure}} + \\varepsilon, observed R² regression p-value calculated. Adaptive resampling assess whether observed R² deviates null, outcome effect sizes permuted: Resampling occurs stages, defined resample_stages (e.g., 1,000 → 10,000 → 1,000,000). stage, empirical p-value updated. Resampling stops early empirical p-value exceeds corresponding threshold p_thresholds. Otherwise, next resampling stage triggered. Final output function returns empirical p-value (p_ECT), observed R² (r_std), standard regression p-value (p_std), number supporting SNPs used. insufficient supporting SNPs, function returns placeholder row indicating test performed.","code":""},{"path":"/articles/getting_started.html","id":"usage-1","dir":"Articles","previous_headings":"Effect Consistency Test","what":"Usage","title":"Tutorial for ect","text":"function returns data frame containing: factor_name — tested factor/pathway p_std — p-value observed regression r_std — R² observed regression p_ECT — empirical p-value adaptive resampling num_supp_SNP — number supporting SNPs used test number supporting SNPs < num_snp_cutoff, placeholder row returned.","code":"ECT(   assoc_pair,   factor_name,   num_snp_cutoff = 3,   snp_fdr_cutoff = 0.2,   seeds = 1000,   resample_stages = c(1000, 10000, 1e6),   p_thresholds = c(0.1, 0.001),   col_beta_exposure = \"beta.exposure\",   col_beta_outcome = \"beta.outcome\",   col_pval_exposure = \"pval.exposure\" )"},{"path":"/articles/getting_started.html","id":"example-1","dir":"Articles","previous_headings":"Effect Consistency Test","what":"Example","title":"Tutorial for ect","text":"provide example using small demonstration dataset included package. dataset contains SNP-level association summary statistics already harmonized GWAS (.e., aligned alleles, matched SNPs, retained relevant columns). keep example computationally light, reduce number resampling iterations compared default settings.","code":"dat <- readRDS(   system.file(\"extdata\", \"example_assoc_output.RDS\",               package = \"ect\") )  print(head(dat)) #>          SNP effect_allele.exposure other_allele.exposure effect_allele.outcome #> 1  rs1003342                      A                     G                     A #> 2 rs10142466                      G                     A                     G #> 3 rs10748781                      C                     A                     C #> 4 rs10758669                      C                     A                     C #> 5 rs10761659                      A                     G                     A #> 6 rs10800309                      A                     G                     A #>   other_allele.outcome beta.exposure beta.outcome eaf.exposure eaf.outcome #> 1                    G       0.12270    0.0801818       0.4633      0.4541 #> 2                    A       0.08420   -0.0580054       0.4773      0.5065 #> 3                    A      -0.07677    0.1691790       0.4301      0.4267 #> 4                    A       0.06959    0.1487620       0.3339      0.3496 #> 5                    G      -0.04096   -0.1538110       0.4895      0.4601 #> 6                    G       0.12650    0.1321110       0.3444      0.3422 #>   remove palindromic ambiguous id.outcome chr.outcome se.outcome pval.outcome #> 1  FALSE       FALSE     FALSE     bqg1BA          22  0.0101765 3.296856e-15 #> 2  FALSE       FALSE     FALSE     bqg1BA          14  0.0101460 1.083652e-08 #> 3  FALSE       FALSE     FALSE     bqg1BA          10  0.0100678 2.284021e-63 #> 4  FALSE       FALSE     FALSE     bqg1BA           9  0.0102138 4.698941e-48 #> 5  FALSE       FALSE     FALSE     bqg1BA          10  0.0100347 4.970499e-53 #> 6  FALSE       FALSE     FALSE     bqg1BA           1  0.0104050 6.154602e-37 #>   outcome mr_keep.outcome pval_origin.outcome data_source.outcome chr.exposure #> 1 outcome            TRUE            reported            textfile           22 #> 2 outcome            TRUE            reported            textfile           14 #> 3 outcome            TRUE            reported            textfile           10 #> 4 outcome            TRUE            reported            textfile            9 #> 5 outcome            TRUE            reported            textfile           10 #> 6 outcome            TRUE            reported            textfile            1 #>   pos.exposure z.exposure pval.exposure samplesize.exposure se.exposure #> 1     30570022     1.9280       0.05491                 286  0.06364108 #> 2     69271784     0.9843       0.32590                 286  0.08554303 #> 3    101283330    -1.1380       0.25610                 286  0.06746046 #> 4      4981602     0.9969       0.31970                 286  0.06980640 #> 5     64445564    -0.6269       0.53130                 286  0.06533737 #> 6    161472158     1.8970       0.05890                 286  0.06668424 #>   exposure mr_keep.exposure pval_origin.exposure id.exposure action SNP_index #> 1 exposure             TRUE             reported      5ewqAI      2         1 #> 2 exposure             TRUE             reported      5ewqAI      2         1 #> 3 exposure             TRUE             reported      5ewqAI      2         1 #> 4 exposure             TRUE             reported      5ewqAI      2         1 #> 5 exposure             TRUE             reported      5ewqAI      2         1 #> 6 exposure             TRUE             reported      5ewqAI      2         1 #>   mr_keep samplesize.outcome FDR.exposure units.outcome units.exposure #> 1    TRUE              34652    0.4240272            NA             NA #> 2    TRUE              34652    0.6899455            NA             NA #> 3    TRUE              34652    0.6899455            NA             NA #> 4    TRUE              34652    0.6899455            NA             NA #> 5    TRUE              34652    0.8101283            NA             NA #> 6    TRUE              34652    0.4309000            NA             NA #>   rsq.exposure effective_n.exposure  rsq.outcome effective_n.outcome #> 1  0.012919576                  286 0.0017884388               34652 #> 2  0.003399833                  286 0.0009423982               34652 #> 3  0.004539315                  286 0.0080834295               34652 #> 4  0.003487127                  286 0.0060849268               34652 #> 5  0.001381903                  286 0.0067348506               34652 #> 6  0.012512609                  286 0.0046309987               34652 #>   steiger_dir steiger_pval #> 1        TRUE    0.2287165 #> 2        TRUE    0.6429863 #> 3       FALSE    0.7040206 #> 4       FALSE    0.7496733 #> 5       FALSE    0.4502789 #> 6        TRUE    0.4592454 ECT_res <- ECT(   dat,   factor_name = \"example\",   num_snp_cutoff = 3,   snp_fdr_cutoff = 0.2,   seeds = 1000,   resample_stages = c(10, 100, 10000),   p_thresholds = c(0.1, 0.001),   col_beta_exposure = \"beta.exposure\",   col_beta_outcome = \"beta.outcome\",   col_pval_exposure = \"pval.exposure\" )  print(ECT_res) #>   factor_name        p_std     r_std    p_ECT num_supp_SNP #> 1     example 0.0002353945 0.7933485 0.009901           10"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Xiaotong Sun. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Sun X (2025). ect: Package Effect Consistency Test. R package version 0.1.0, https://github.com/xsun1229/ect.","code":"@Manual{,   title = {ect: Package for Effect Consistency Test},   author = {Xiaotong Sun},   year = {2025},   note = {R package version 0.1.0},   url = {https://github.com/xsun1229/ect}, }"},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Package for Effect Consistency Test","text":"can install development version ect GitHub : load ","code":"# install.packages(\"devtools\") devtools::install_github(\"xsun1229/ect\") library(ect)"},{"path":"/index.html","id":"overview-of-the-functions","dir":"","previous_headings":"","what":"Overview of the Functions","title":"Package for Effect Consistency Test","text":"provide two main functions package: prune_snps() — Select independent SNPs Selects independent SNPs using PLINK clumping LD pruning. ECT() — Effect Consistency Test Performs adaptive resampling test assess whether SNP effect directions outcome (GWAS trait) consistent exposure (pathway factor).","code":""},{"path":"/index.html","id":"full-tutorial","dir":"","previous_headings":"","what":"Full tutorial","title":"Package for Effect Consistency Test","text":"https://xsun1229.github.io/ect/articles/getting_started.html","code":""},{"path":"/reference/ECT.html","id":null,"dir":"Reference","previous_headings":"","what":"Effect Consistency Test (ECT) — ECT","title":"Effect Consistency Test (ECT) — ECT","text":"Performs adaptive resampling-based Effect Consistency Test (ECT) evaluate whether SNP effect sizes outcome (e.g.,GWAS trait) consistent exposure (e.g., pathway-level factor). test compares observed R² exposure–outcome regression null distribution obtained permutation outcome effects.","code":""},{"path":"/reference/ECT.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Effect Consistency Test (ECT) — ECT","text":"","code":"ECT(   assoc_pair,   factor_name,   num_snp_cutoff = 3,   snp_fdr_cutoff = 0.2,   seeds = 1000,   resample_stages = c(1000, 10000, 1e+06),   p_thresholds = c(0.1, 0.001),   col_beta_exposure = \"beta.exposure\",   col_beta_outcome = \"beta.outcome\",   col_pval_exposure = \"pval.exposure\" )"},{"path":"/reference/ECT.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Effect Consistency Test (ECT) — ECT","text":"assoc_pair Data frame containing association summary statistics given factor. Must include columns specified col_beta_exposure, col_beta_outcome, col_pval_exposure. factor_name Character string indicating name factor pathway. num_snp_cutoff Minimum number supporting SNPs required perform test (default: 3). snp_fdr_cutoff FDR threshold used select supporting SNPs based col_pval_exposure (default: 0.2). seeds Base random seed reproducibility (default: 1000). resample_stages Integer vector specifying number resampling iterations adaptive stage (default: c(1e3, 1e4, 1e6)). p_thresholds Numeric vector stopping thresholds adaptive resampling (default: c(0.1, 0.001)). col_beta_exposure Column name exposure effect sizes (default: \"beta.exposure\"). col_beta_outcome Column name outcome effect sizes (default: \"beta.outcome\"). col_pval_exposure Column name exposure p-values (default: \"pval.exposure\").","code":""},{"path":"/reference/ECT.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Effect Consistency Test (ECT) — ECT","text":"data frame containing following columns: factor_name: factor/pathway tested p_std: p-value observed linear regression r_std: R² observed regression p_ECT: empirical p-value adaptive resampling num_supp_SNP: number SNPs used test number supporting SNPs num_snp_cutoff, function returns placeholder row indicating insufficient SNPs.","code":""},{"path":"/reference/ECT.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Effect Consistency Test (ECT) — ECT","text":"function fits -intercept linear model: $$beta_outcome ~ 0 + beta_exposure$$ compares R² obtained permuting outcome effect sizes. Resampling proceeds progressively larger sample sizes empirical p-value exceeds corresponding threshold p_thresholds stages completed.","code":""},{"path":"/reference/ECT.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Effect Consistency Test (ECT) — ECT","text":"","code":"if (FALSE) { # \\dontrun{ ECT(   assoc_pair = mydata,   factor_name = \"pathway_PC1\",   snp_fdr_cutoff = 0.1,   resample_stages = c(1e3, 1e4),   p_thresholds = c(0.05, 0.001) ) } # }"},{"path":"/reference/prune_snps.html","id":null,"dir":"Reference","previous_headings":"","what":"Prune SNPs based on clumping and LD thresholds using PLINK — prune_snps","title":"Prune SNPs based on clumping and LD thresholds using PLINK — prune_snps","text":"Performs SNP pruning two stages: (1) PLINK-based clumping select approximately independent lead SNPs, (2) additional distance- LD-based pruning reduce correlated variants. function generates temporary files subdirectory .dir, invokes PLINK commands, returns pruned GWAS summary statistics table.","code":""},{"path":"/reference/prune_snps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prune SNPs based on clumping and LD thresholds using PLINK — prune_snps","text":"","code":"prune_snps(   file_sumstats,   plink_path,   bfile,   out.dir,   out.pref,   clean_up = FALSE )"},{"path":"/reference/prune_snps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prune SNPs based on clumping and LD thresholds using PLINK — prune_snps","text":"file_sumstats Path GWAS summary statistics file containing columns SNP, CHR, BP, P. plink_path Path PLINK executable. bfile PLINK binary file prefix (.bed/.bim/.fam) used LD reference. .dir Output directory intermediate result files written. .pref Prefix temporary PLINK output final file naming. clean_up Logical; TRUE, temporary files subdirectories deleted successful completion errors occur.","code":""},{"path":"/reference/prune_snps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prune SNPs based on clumping and LD thresholds using PLINK — prune_snps","text":"data.table pruned GWAS summary statistics containing columns input file restricted SNPs remain distance- LD-based pruning. Returns NULL PLINK clumping fails produce output.","code":""},{"path":"/reference/prune_snps.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prune SNPs based on clumping and LD thresholds using PLINK — prune_snps","text":"pruning proceeds following steps: PLINK clumping: using thresholds --clump-p1 5e-8, --clump-p2 1e-3, --clump-r2 0.1, --clump-kb 1000. Distance-based pruning: removes SNPs within ±1 Mb significant SNP. LD-based pruning: calculates pairwise LD (r²) using PLINK removes SNPs r² > 0.1 relative previously retained variants. Returns GWAS summary statistics restricted remaining independent SNPs.","code":""},{"path":"/reference/prune_snps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prune SNPs based on clumping and LD thresholds using PLINK — prune_snps","text":"","code":"if (FALSE) { # \\dontrun{ pruned_gwas <- prune_snps(   file_sumstats = \"assoc/gwas.txt\",   plink_path = \"/usr/bin/plink\",   bfile = \"ref/1000G_EUR\",   out.dir = \"pruning_results/\",   out.pref = \"GWAS1\",   clean_up = TRUE ) } # }"},{"path":"/reference/run_snps_assoc.html","id":null,"dir":"Reference","previous_headings":"","what":"Run PLINK-based SNP association analyses in parallel — run_snps_assoc","title":"Run PLINK-based SNP association analyses in parallel — run_snps_assoc","text":"Performs SNP-level association analyses given list SNPs invoking PLINK parallel. SNP tested using covariate file, association results can optionally grouped phenotype factors.","code":""},{"path":"/reference/run_snps_assoc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run PLINK-based SNP association analyses in parallel — run_snps_assoc","text":"","code":"run_snps_assoc(   snp_list,   folder_covar,   folder_assoc,   plink_path,   file_bfile,   file_phe,   single_factor = NULL,   add_MAF = TRUE,   df_maf = NULL,   ncores = 4,   cleanup = FALSE,   group_by_factor = TRUE )"},{"path":"/reference/run_snps_assoc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run PLINK-based SNP association analyses in parallel — run_snps_assoc","text":"snp_list Character vector SNP IDs analyze. folder_covar Path folder containing SNP-specific covariate files, PLINK format (e.g., \"snp123.cov.txt\"). folder_assoc Path output folder PLINK association results. plink_path Path PLINK executable. file_bfile PLINK binary file prefix (.bed/.bim/.fam). file_phe Path phenotype file analyzed PLINK. file contain phenotype columns (.e., factors) later referenced group_by_factor group summarize association results. single_factor Optional; single phenotype name (column name file_phe) test individually. NULL, phenotypes file_phe analyzed (---pheno mode). add_MAF Logical; TRUE, function merges association results MAF table. add_MAF = TRUE, argument df_maf must provided. FALSE, MAF information ignored df_maf can left NULL. df_maf Data frame containing columns SNP, A2, MAF. Required add_MAF = TRUE; otherwise leave NULL. ncores Number CPU cores use parallel processing. cleanup Logical; TRUE, removes intermediate .assoc files grouping. group_by_factor Logical; TRUE, function combines SNP-level results groups phenotype factors defined file_phe.","code":""},{"path":"/reference/run_snps_assoc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run PLINK-based SNP association analyses in parallel — run_snps_assoc","text":"Writes PLINK association results folder_assoc/ (optionally) grouped per-factor summary files (e.g., \"factor_pvalues.txt\"). Returns explicit object.","code":""},{"path":"/reference/run_snps_assoc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run PLINK-based SNP association analyses in parallel — run_snps_assoc","text":"SNP processed subfolder folder_assoc/ avoid overwriting parallel execution. additive test results (TEST == \"ADD\") retained.","code":""},{"path":"/reference/run_snps_assoc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run PLINK-based SNP association analyses in parallel — run_snps_assoc","text":"","code":"if (FALSE) { # \\dontrun{ run_snps_assoc(   snp_list = c(\"rs123\", \"rs456\"),   folder_covar = \"covariates/\",   folder_assoc = \"assoc_results/\",   plink_path = \"/usr/bin/plink\",   file_bfile = \"data/genotypes\",   file_phe = \"data/pheno.txt\",   add_MAF = TRUE,   df_maf = maf_table,   ncores = 4 ) } # }"}]
